#!/usr/bin/env bash

# Synopsis:
# Test the track's exercises.
#
# For each exercise we type-check the template solution (which is
# provided to the students) and test if the example solution
# .meta/example.sml passes the tests.
#
# Usage:
# ./bin/test [slug...]

all_slugs="$*"
if [ -z $all_slugs ]; then
  all_slugs=$(ls ./exercises/practice/)
fi

docker run --rm -it --entrypoint bash \
       -v $(realpath ./exercises):/exercises:z  \
       -v $(realpath ./scripts):/scripts:z \
       exercism/sml-test-runner \
       /scripts/test-in-docker.sh $all_slugs

exit_code=$?

exit ${exit_code}
